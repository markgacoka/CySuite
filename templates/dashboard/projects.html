{% extends '../base.html' %}
{% load static %}
{% load custom_tags %}
{% block title%}
Projects | CySuite
{% endblock %}

{% block content %}
<div class="asset-container">
    <button class="asset-btn" style="background-color: #3E4261"><i class="fa fa-plus" style="color: white;"></i>&emsp;Add Asset</button>
</div>
{% if success_message %}
    <button style="display: none;" class="alert-popup" id="alert-success" name="{{success_message}}" value="success"></button>
{% endif %}
{% if feedback_form.errors %}
    {% for field in feedback_form %}
        {% for error in field.errors %}
            <button style="display: none;" class="alert-popup" id="alert-danger" name="{{error}}" value="danger"></button>
        {% endfor %}
    {% endfor%}
{% endif %}
{% if feedback_form.non_field_errors %}
    <button style="display: none;" class="alert-popup" id="alert-danger" name="{{feedback_form.non_field_errors}}" value="danger"></button>
{% endif %}
<div class="modal-overlay">
    <form method="post">
    {% csrf_token %}
    <div class="modal">
        <a class="close-modal">
        <svg viewBox="0 0 20 20">
            <path fill="#000000" d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z"></path>
        </svg>
        </a>
        <div style="margin: 2rem 2rem 2rem 2rem;">
            <h1 class="mb-4">Add a new project</h1>
            <div class="input-group mb-3">
                <span class="input-group-text" style="color: white; background-color: #3E4261; width: 9rem;">Project Name</span>
                <input type="text" name="project_name" class="flex-grow-1 form-control" style="height: auto;">
            </div>
            <div class="input-group mb-3">
                <span class="input-group-text" style="color: white; background-color: #3E4261; width: 9rem;">Program</span>
                <select class="form-select flex-grow-1 select-dropdown" name="program">
                    <option>HackerOne</option>
                    <option>BugCrowd</option>
                    <option>Intigriti</option>
                    <option>Synack</option>
                    <option>Custom</option>
                </select>
            </div>
            <h3>In scope domains</h3>
            <h6>Add each domain seperated by a new line (*.site.com allowed)</h3>
            <textarea style="width: 100%; height: 15rem;" type="text" id="domains" name="in_scope_domains"></textarea>
            <button class="scan-btn" type="submit" style="background-color: #3E4261">
                <i class="fa fa-search" style="color: white;"></i>&nbsp;Scan
            </button>
            <h6>Logs</h6>
            <small>Starting.... 0%</small><br/>
            <small>Extracting subdomains from ThreatCrowd.... 20%</small><br/>
            <small>Extracting subdomains from WaybackMachine.... 35%</small>
        </div>
    </div>
    </form>
</div>
{% for project_ele in project_list %}
    <div class="project-column" style="display: block; float: right;  width: 50%;">
        <div class="courses-container">
            <div class="course">
                <div class="course-preview" style="background-color: #3E4261">
                    <h6 class="project-category">Program</h6>
                    <h3 class="project-title">{{project_ele|get_item:"program"}}</h3>
                </div>
                <div class="course-info">
                    <h6>Asset</h6>
                    <h3>{{project_ele|get_item:"project"}}</h3>
                        <div style="float: left; width: 60%;">
                            <p class="mb-2 fw-bold">Progress <span class="float-end">{{project_ele|get_item:"progress"}}%</span></p>
                            <div class="progress progress-sm">
                                <div class="progress-bar" role="progressbar" aria-valuenow="{{project_ele|get_item:"progress"}}" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
                                </div>
                            </div>
                        </div>
                        <div style="float: right; width: 30%;">
                            <button class="project-btn btn-width" style="background-color: #3E4261; min-width: max-content;">View&emsp;<i class="hide fa fa-angle-double-right"></i></button>
                        </div>
                </div>
            </div>
        </div>
    </div>
{% endfor %}
{% endblock %}
{% block js %}
<script>
    var elements = $('.modal-overlay, .modal');   
    $('button').click(function(){
        elements.addClass('active');
    });
    $('.close-modal').click(function(){
        elements.removeClass('active');
    });
</script>
{% endblock %}